<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
		<meta name="description" content="和数据大咖公事,与游戏战队共娱,携先锋部队共战">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="apple-touch-fullscreen" content="yes" />
		<meta name="format-detection" content="telephone=no,email=no" />
		<title>加入DataEye</title>
		<link rel="stylesheet" href="/css/jobs.css?v=4">
		<!-- <link rel="stylesheet" href="/css/animate.min.css"> -->
	</head>
	<body>
		<div class="page-home" id="home" style="display: none;">
			<div class="bg-wrapper">
				<div class="bg bg-1" data="1" id="bg-1">
					<div class="bgc bg-1-1">
						<img data-src="/img/jobs/page01-01.png" alt="">
					</div>

					<div class="touchstyle-arrowup"
						style="opacity: 0; -webkit-animation: touchstyle-arrow-animate 2s infinite;">
					</div>
				</div>

				<div class="bg bg-2" data="2" id="bg-2">
					<div class="bgc bg-2-1">
						<div class="bg-2-1-1">
							<img data-src="/img/jobs/page02-01.png" alt="">
						</div>
						<div class="bg-2-1-2">
							<img data-src="/img/jobs/page02-02.png" alt="">
						</div>
						<div class="bg-2-1-3">
							<img data-src="/img/jobs/page02-03.png" alt="">
						</div>
					</div>

					<div class="touchstyle-arrowup"
						style="opacity: 0; -webkit-animation: touchstyle-arrow-animate 2s infinite;">
					</div>
				</div>

				<div class="bg bg-3" data="3" id="bg-3">
					<div class="bgc bg3 bg-3-1">
						<img data-src="/img/jobs/page03-01.png" alt="">
					</div>
					<div class="touchstyle-arrowup"
						style="opacity: 0; -webkit-animation: touchstyle-arrow-animate 2s infinite;">
					</div>
				</div>

				<div class="bg bg-31" id="bg-31">
					<div class="bgc bg3 bg-3-2">
						<img data-src="/img/jobs/page03-02.png" alt="">
					</div>
					<div class="touchstyle-arrowup"
						style="opacity: 0; -webkit-animation: touchstyle-arrow-animate 2s infinite;">
					</div>
				</div>

				<div class="bg bg-32" id="bg-32">
					<div class="bgc bg3 bg-3-3">
						<img data-src="/img/jobs/page03-03.png" alt="">
					</div>
					<div class="bgc bg3 bg-3-4">
						<img data-src="/img/jobs/page03-04.png" alt="">
					</div>

					<div class="touchstyle-arrowup"
						style="opacity: 0; -webkit-animation: touchstyle-arrow-animate 2s infinite;">
					</div>
				</div>

				<div class="bg bg-4" data="4" id="bg-4">
					<div class="bgc bg-4-1">
						<div class="bg-4-1-1">
							<img data-src="/img/jobs/page04-01.png" alt="">
						</div>
						<div class="bgc bg-4-1-2">
							<img data-src="/img/jobs/page04-02.png" alt="">
						</div>
					</div>

					<a href="/jobs/list" id="view_pos_list">查看职位列表</a>
				</div>
			</div>
		</div>

		<div id="loading" style="display: block;">
			<div class="spinner">
		    <div class="spinner-container container1">
		      <div class="circle1"></div>
		      <div class="circle2"></div>
		      <div class="circle3"></div>
		      <div class="circle4"></div>
		    </div>
		    <div class="spinner-container container2">
		      <div class="circle1"></div>
		      <div class="circle2"></div>
		      <div class="circle3"></div>
		      <div class="circle4"></div>
		    </div>
		    <div class="spinner-container container3">
		      <div class="circle1"></div>
		      <div class="circle2"></div>
		      <div class="circle3"></div>
		      <div class="circle4"></div>
		    </div>
		  </div>
		</div>

		<script src="/js/jquery-2.1.1.min.js"></script>
		<script src="/js/WeixinApi.js"></script>
		<script src="/js/dcagent.min.js?v=9"></script>
		<script>
			$(function() {
				DCAgent.init({
          appId: '4DFD99AC805A9918AD5B8AB2016EC322'
				})
			})
	    // 微信分享的数据
	    var wxData = {
        "imgUrl" : 'http://career.gdatacube.net/img/jobs/dataeye.jpg',
        "link" : 'http://career.gdatacube.net/jobs',
        "desc" : '专业的人做专注的事,精细化运营助力精品游戏。现在就加入DataEye，和数据大咖共事，与游戏战队共娱，携先锋部队共战',
        "title" : "全球猎Eye, DataEye需要你"
	    }
			WeixinApi.share(wxData, {})

			function loadImages(sources, callback) {
		    var count = 0, images = {}, imgNum = 0;
		    for (src in sources) {
        	imgNum++;
		    }
		    for (src in sources) {
	        images[src] = new Image();
	        images[src].onload = function() {
            if (++count >= imgNum) {
              callback(images);
            }
	        }
	        images[src].src = sources[src];
		    }
			}

			var imgs = [
				'/img/jobs/bg01.jpg',
				'/img/jobs/bg02.jpg',
				'/img/jobs/bg03.jpg',
				'/img/jobs/bg04.jpg'
			]

			var bg3Func =function(i) {
				return function() {
					$('.bg3').eq(i).hide().removeClass('animated zoomIn')
					setTimeout(function() {
						$('.bg3').eq(i).show().addClass('animated zoomIn')
					}, 10)
				}
			}
			// 滑动结束时的执行时间，一一对应到索引
			var callbacks = [
				function() {
					$('.bg-1-1').hide().removeClass('animated bounceInDown')
					setTimeout(function() {
						$('.bg-1-1').show().addClass('animated bounceInDown')
					}, 10)
				},
				function() {
					$('.bg-2-1').hide().removeClass('animated zoomIn')
					setTimeout(function() {
						$('.bg-2-1').show().addClass('animated zoomIn')
					}, 10)
				},
				bg3Func(0), bg3Func(1),
				function() {
					$('.bg-3-3, .bg-3-4').hide().removeClass('animated zoomIn')
					setTimeout(function() {
						$('.bg-3-3').show().addClass('animated zoomIn')
					}, 10)
				},
				function() {
					$('.bg-4-1').hide().removeClass('animated zoomIn')
					setTimeout(function() {
						$('.bg-4-1').show().addClass('animated zoomIn')
					}, 10)
				}
			]
			loadImages(imgs, function() {
				$('#loading').hide()
				$('#home').show()
				$('img[data-src]').attr('src', function(){return $(this).attr('data-src')})

				var height = document.documentElement.clientHeight
		    $('.bg').css('height', height + 'px').eq(0).show()
		    $('.bg-wrapper').css('height', height * callbacks.length + 'px')

		    var wrapper = $('.bg-wrapper')[0]
		    var startY = 0
		    var moveY = 0
		    var startTop = 0
		    var newTop = 0
		    var animation = true
		    wrapper.addEventListener('touchstart', function(event) {
		    	if (event.target.tagName == 'A') {
		    		return
		    	}
		    	event.preventDefault();
			    var touch = event.targetTouches[0]; //位于当前DOM元素上的手指的一个列表
			    startY = touch.pageY;
			    moveY = 0;
			    startTop = parseInt($(this).css('top'))
		    }, false)

		    wrapper.addEventListener('touchmove', function(event) {
		    	if (event.target.tagName == 'A') {
		    		return
		    	}
		    	event.preventDefault();
		    	var touch = event.targetTouches[0]
		    	moveY = touch.pageY - startY

		    	var top = parseInt($(this).css('top'))
		    	// 顶部下拉禁止移动
		    	if (top >= 0 && moveY >= 0) {
		    		animation = false
		    		return
		    	}
		    	// 底部上拉禁止移动
		    	if(top == -1 * (callbacks.length - 1) * height && moveY <= 0) {
		    		animation = false
		    		return
		    	}

		    	animation = true
		    	newTop = startTop + moveY
		    	if (newTop > 0 ) {
		    		newTop = 0
		    	} else if (newTop < -1 * height * (callbacks.length - 1)) {
		    		newTop = -1 * height * (callbacks.length - 1)
		    	}
	    		$(this).css('top', newTop + 'px')
		    }, false)

		    wrapper.addEventListener('touchend', function(event) {
		    	if (event.target.tagName == 'A' || moveY === 0) {
		    		return
		    	}
		    	event.preventDefault()
		    	if (animation) {
		    		// 下拉
		    		if(moveY > 0) {
		    			newTop = parseInt(newTop/height) * height
		    		}

			    	var abs = Math.abs(newTop)
			    	if (abs > 0 && abs <= height) {
			    		newTop = -1 * height
			    	}

			    	var stepNum = Math.min(Math.ceil(abs/height), callbacks.length - 1)
			    	newTop = -1 * stepNum * height

			    	$(this).animate({top: newTop + 'px'}, 200, 'linear', function() {
			    		$('.bgc').hide()
			    		callbacks[stepNum] && callbacks[stepNum]()
			    	})
		    	}
		    }, false)

		    $('.bg-1-1').show().addClass('animated bounceInDown')
		    $('.bg-3-3').on('webkitAnimationEnd animationEnd', function() {
		    	$(this).hide()
		    	$('.bg-3-4').show().addClass('animated zoomIn')
		    })
			})

		</script>
