<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />
		<meta name="apple-touch-fullscreen" content="yes" />
		<meta name="format-detection" content="telephone=no,email=no" />
		<title>加入DataEye</title>
		<link rel="stylesheet" href="./css/jquery.mobile-1.4.5.min.css">
		<link rel="stylesheet" href="./css/jobs.css">
	</head>
	<body>
		<% include ./incs/home.ejs %>

		<% include ./incs/positions.ejs %>

		<% include ./incs/contact.ejs %>

		<script src="./js/jquery-2.1.1.min.js"></script>
		<script src="./js/jquery.mobile-1.4.5.min.js"></script>
		<script>
			$(function() {
				if(location.hash) {
					location.href = location.href.split('#')[0] + '#'
				}
				$('#pos li>a').on('tap', function() {
					$('#pos_list').css('margin-bottom', $('#tools').outerHeight() + 'px')
					if($(this).hasClass('ui-icon-carat-r')) {
						$(this).removeClass('ui-icon-carat-r').addClass('ui-icon-carat-d')
							.siblings().slideDown()
					} else {
						$(this).removeClass('ui-icon-carat-d').addClass('ui-icon-carat-r')
							.siblings().slideUp()
					}
				})

				$('#share').on('tap', function() {
					alert('打开右上角菜单，点击“发送给朋友”或者“分享到朋友圈”')
				})

				$('#form1').on('submit', function(e) {
					e.preventDefault()
					var form = $('#form1')[0]
					var data = {
						nickname: form.nickname.value,
						tel: form.tel.value,
						qq: form.qq.value,
						position: form.position.value
					}
					if(!data.nickname || !data.tel) {
						return alert('请填写昵称和联系电话')
					}
					$.ajax({
						url: '/jobs/send',
						type: 'POST',
						dataType: 'json',
						data: data,
						success: function() {
							alert('您的信息已提交，感谢关注DataEye。我们的工作人员会在24小时内和您取得联系，请保持联系方式畅通。')
							form.reset()
							location.href = '#pos'
						},
						error: function(xhr, status, text) {
							alert(xhr.responseText)
						}
					})
					return false
				})

			})
		</script>
